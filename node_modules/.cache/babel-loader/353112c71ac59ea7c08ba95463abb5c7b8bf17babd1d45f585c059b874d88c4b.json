{"ast":null,"code":"var _s = $RefreshSig$();\nimport { createContext, useCallback, useContext, useMemo } from \"react\";\nimport en from './en';\nimport cn from './cn';\n\n// A type define for the translator book\n\nlet currentLocale = \"cn\";\nexport const initialContextValue = {\n  locale: currentLocale,\n  setLocale\n};\nexport const LocaleContext = /*#__PURE__*/createContext(initialContextValue);\nlet deps;\n// A function that initializes the locale, and sets the default locale to \"en\"\nexport async function init(_deps) {\n  deps = _deps;\n  const item = await localStorage.getItem(deps.storageKey);\n  if (item) {\n    currentLocale = item;\n  } else {\n    currentLocale = deps.defaultLocale;\n  }\n}\n// A static function to set the locale\nexport async function setLocale(locale) {\n  currentLocale = locale;\n  await localStorage.setItem(currentLocale, currentLocale);\n}\n\n// A static function to get the locale\nexport function getLocale() {\n  return currentLocale;\n}\n// A class that defines the translator\nexport class Translator {\n  constructor(book) {\n    this.book = book;\n  }\n  static from(book) {\n    return new Translator(book);\n  }\n  loadBy(locale) {\n    return this.book[locale];\n  }\n}\nconst book = defineLangBook({\n  cn,\n  en\n});\n// A Hook that uses the translator book: LangBook<T>\nexport function useLangBook(book) {\n  _s();\n  const {\n    locale: _currentLocale\n  } = useContext(LocaleContext);\n  const currentBook = useMemo(() => Translator.from(book).loadBy(_currentLocale), [book, _currentLocale]);\n  const T = useCallback(text => {\n    var _currentBook$text;\n    return (_currentBook$text = currentBook === null || currentBook === void 0 ? void 0 : currentBook[text]) !== null && _currentBook$text !== void 0 ? _currentBook$text : text;\n  }, [currentBook]);\n  return {\n    T,\n    currentBook\n  };\n}\n\n// A function that defines the book, and return the book\n_s(useLangBook, \"Red5Lie7WYP+FomnZMLfOIXZJ1U=\");\nexport function defineLangBook(book) {\n  return book;\n}\nexport default defineLangBook({\n  cn,\n  en\n});","map":{"version":3,"names":["createContext","useCallback","useContext","useMemo","en","cn","currentLocale","initialContextValue","locale","setLocale","LocaleContext","deps","init","_deps","item","localStorage","getItem","storageKey","defaultLocale","setItem","getLocale","Translator","constructor","book","from","loadBy","defineLangBook","useLangBook","_s","_currentLocale","currentBook","T","text","_currentBook$text"],"sources":["/Users/summer/Desktop/2/filbet-client-web-ui/src/lang/i18n.ts"],"sourcesContent":["import { createContext, useCallback, useContext, useMemo } from \"react\"\nimport en from './en';\nimport cn from './cn';\nexport type Locale = \"cn\" | \"en\"\n\nexport type ContextLocale = {\n\tlocale: Locale\n\tsetLocale(locale: Locale): Promise<void>\n}\n\n// A type define for the translator book\nexport type LangBook<T extends string> = Record<Locale, Record<T, string>>\n\nexport type UnionLangBook<\n\tT extends string,\n\tBooks extends LangBook<T extends infer U ? U : never>[],\n> = Books\n\nlet currentLocale: Locale = \"cn\"\n\nexport const initialContextValue: ContextLocale = {\n\tlocale: currentLocale,\n\tsetLocale,\n}\n\nexport const LocaleContext = createContext<ContextLocale>(initialContextValue)\n\ntype Deps = {\n\tstorageKey: string\n\tdefaultLocale: Locale\n}\n\nlet deps: Deps\n// A function that initializes the locale, and sets the default locale to \"en\"\nexport async function init(_deps: Deps) {\n\tdeps = _deps\n\tconst item = await localStorage.getItem(deps.storageKey)\n\tif (item) {\n\t\tcurrentLocale = item as Locale\n\t} else {\n\t\tcurrentLocale = deps.defaultLocale\n\t}\n}\n// A static function to set the locale\nexport async function setLocale(locale: Locale) {\n\tcurrentLocale = locale\n\tawait localStorage.setItem(currentLocale,currentLocale)\n}\n\n// A static function to get the locale\nexport function getLocale(): Locale {\n\treturn currentLocale\n}\n// A class that defines the translator\nexport class Translator<T extends string> {\n\tprivate constructor(private readonly book: LangBook<T>) {}\n\n\tstatic from<T extends string>(book: LangBook<T>) {\n\t\treturn new Translator(book)\n\t}\n\n\tloadBy(locale: Locale) {\n\t\treturn this.book[locale]\n\t}\n}\nconst book = defineLangBook({\n\tcn,\n\ten,\n});\n// A Hook that uses the translator book: LangBook<T>\nexport function useLangBook<T extends string>(book: LangBook<T>) {\n\n\n\tconst { locale: _currentLocale } = useContext(LocaleContext)\n\tconst currentBook = useMemo(\n\t\t() => Translator.from(book).loadBy(_currentLocale),\n\t\t[book, _currentLocale],\n\t)\n\tconst T = useCallback(\n\t\t(text: T) => {\n\t\t\treturn currentBook?.[text] ?? text\n\t\t},\n\t\t[currentBook],\n\t)\n\treturn {\n\t\tT,\n\t\tcurrentBook,\n\t}\n}\n\n// A function that defines the book, and return the book\nexport function defineLangBook<T extends string>(book: LangBook<T>) {\n\treturn book\n}\n\nexport default defineLangBook({\n\tcn,\n\ten,\n})"],"mappings":";AAAA,SAASA,aAAa,EAAEC,WAAW,EAAEC,UAAU,EAAEC,OAAO,QAAQ,OAAO;AACvE,OAAOC,EAAE,MAAM,MAAM;AACrB,OAAOC,EAAE,MAAM,MAAM;;AAQrB;;AAQA,IAAIC,aAAqB,GAAG,IAAI;AAEhC,OAAO,MAAMC,mBAAkC,GAAG;EACjDC,MAAM,EAAEF,aAAa;EACrBG;AACD,CAAC;AAED,OAAO,MAAMC,aAAa,gBAAGV,aAAa,CAAgBO,mBAAmB,CAAC;AAO9E,IAAII,IAAU;AACd;AACA,OAAO,eAAeC,IAAIA,CAACC,KAAW,EAAE;EACvCF,IAAI,GAAGE,KAAK;EACZ,MAAMC,IAAI,GAAG,MAAMC,YAAY,CAACC,OAAO,CAACL,IAAI,CAACM,UAAU,CAAC;EACxD,IAAIH,IAAI,EAAE;IACTR,aAAa,GAAGQ,IAAc;EAC/B,CAAC,MAAM;IACNR,aAAa,GAAGK,IAAI,CAACO,aAAa;EACnC;AACD;AACA;AACA,OAAO,eAAeT,SAASA,CAACD,MAAc,EAAE;EAC/CF,aAAa,GAAGE,MAAM;EACtB,MAAMO,YAAY,CAACI,OAAO,CAACb,aAAa,EAACA,aAAa,CAAC;AACxD;;AAEA;AACA,OAAO,SAASc,SAASA,CAAA,EAAW;EACnC,OAAOd,aAAa;AACrB;AACA;AACA,OAAO,MAAMe,UAAU,CAAmB;EACjCC,WAAWA,CAAkBC,IAAiB,EAAE;IAAA,KAAnBA,IAAiB,GAAjBA,IAAiB;EAAG;EAEzD,OAAOC,IAAIA,CAAmBD,IAAiB,EAAE;IAChD,OAAO,IAAIF,UAAU,CAACE,IAAI,CAAC;EAC5B;EAEAE,MAAMA,CAACjB,MAAc,EAAE;IACtB,OAAO,IAAI,CAACe,IAAI,CAACf,MAAM,CAAC;EACzB;AACD;AACA,MAAMe,IAAI,GAAGG,cAAc,CAAC;EAC3BrB,EAAE;EACFD;AACD,CAAC,CAAC;AACF;AACA,OAAO,SAASuB,WAAWA,CAAmBJ,IAAiB,EAAE;EAAAK,EAAA;EAGhE,MAAM;IAAEpB,MAAM,EAAEqB;EAAe,CAAC,GAAG3B,UAAU,CAACQ,aAAa,CAAC;EAC5D,MAAMoB,WAAW,GAAG3B,OAAO,CAC1B,MAAMkB,UAAU,CAACG,IAAI,CAACD,IAAI,CAAC,CAACE,MAAM,CAACI,cAAc,CAAC,EAClD,CAACN,IAAI,EAAEM,cAAc,CACtB,CAAC;EACD,MAAME,CAAC,GAAG9B,WAAW,CACnB+B,IAAO,IAAK;IAAA,IAAAC,iBAAA;IACZ,QAAAA,iBAAA,GAAOH,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAGE,IAAI,CAAC,cAAAC,iBAAA,cAAAA,iBAAA,GAAID,IAAI;EACnC,CAAC,EACD,CAACF,WAAW,CACb,CAAC;EACD,OAAO;IACNC,CAAC;IACDD;EACD,CAAC;AACF;;AAEA;AAAAF,EAAA,CApBgBD,WAAW;AAqB3B,OAAO,SAASD,cAAcA,CAAmBH,IAAiB,EAAE;EACnE,OAAOA,IAAI;AACZ;AAEA,eAAeG,cAAc,CAAC;EAC7BrB,EAAE;EACFD;AACD,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}